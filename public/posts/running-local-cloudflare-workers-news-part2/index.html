<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Running Local Cloudflare Workers to Gather News Information - Part 2 | Just a Guy, from Kenya</title>
<meta name="keywords" content="cloudflare, workers, web scraping, typescript, serverless">
<meta name="description" content="Introduction
In Part 1, we covered the basics of Cloudflare Workers and set up our project. Now, let&rsquo;s dive into the core implementation details that make our news gathering worker function.
This post focuses on three crucial aspects:

Cookie management for authenticated access
Article fetching and parsing techniques
Error handling and debugging strategies

Cookie Management System
Many modern websites, including Nation Africa, use cookies for session management and paywalls. To access full content, we need to maintain valid session cookies.">
<meta name="author" content="">
<link rel="canonical" href="https://www.guyfromtheke.com/posts/running-local-cloudflare-workers-news-part2/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.guyfromtheke.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.guyfromtheke.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.guyfromtheke.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.guyfromtheke.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.guyfromtheke.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://www.guyfromtheke.com/posts/running-local-cloudflare-workers-news-part2/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://www.guyfromtheke.com/posts/running-local-cloudflare-workers-news-part2/">
  <meta property="og:site_name" content="Just a Guy, from Kenya">
  <meta property="og:title" content="Running Local Cloudflare Workers to Gather News Information - Part 2">
  <meta property="og:description" content="Introduction In Part 1, we covered the basics of Cloudflare Workers and set up our project. Now, let’s dive into the core implementation details that make our news gathering worker function.
This post focuses on three crucial aspects:
Cookie management for authenticated access Article fetching and parsing techniques Error handling and debugging strategies Cookie Management System Many modern websites, including Nation Africa, use cookies for session management and paywalls. To access full content, we need to maintain valid session cookies.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-07T22:53:51+03:00">
    <meta property="article:modified_time" content="2025-04-07T22:53:51+03:00">
    <meta property="article:tag" content="Cloudflare">
    <meta property="article:tag" content="Workers">
    <meta property="article:tag" content="Web Scraping">
    <meta property="article:tag" content="Typescript">
    <meta property="article:tag" content="Serverless">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Running Local Cloudflare Workers to Gather News Information - Part 2">
<meta name="twitter:description" content="Introduction
In Part 1, we covered the basics of Cloudflare Workers and set up our project. Now, let&rsquo;s dive into the core implementation details that make our news gathering worker function.
This post focuses on three crucial aspects:

Cookie management for authenticated access
Article fetching and parsing techniques
Error handling and debugging strategies

Cookie Management System
Many modern websites, including Nation Africa, use cookies for session management and paywalls. To access full content, we need to maintain valid session cookies.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.guyfromtheke.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Running Local Cloudflare Workers to Gather News Information - Part 2",
      "item": "https://www.guyfromtheke.com/posts/running-local-cloudflare-workers-news-part2/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Running Local Cloudflare Workers to Gather News Information - Part 2",
  "name": "Running Local Cloudflare Workers to Gather News Information - Part 2",
  "description": "Introduction In Part 1, we covered the basics of Cloudflare Workers and set up our project. Now, let\u0026rsquo;s dive into the core implementation details that make our news gathering worker function.\nThis post focuses on three crucial aspects:\nCookie management for authenticated access Article fetching and parsing techniques Error handling and debugging strategies Cookie Management System Many modern websites, including Nation Africa, use cookies for session management and paywalls. To access full content, we need to maintain valid session cookies.\n",
  "keywords": [
    "cloudflare", "workers", "web scraping", "typescript", "serverless"
  ],
  "articleBody": "Introduction In Part 1, we covered the basics of Cloudflare Workers and set up our project. Now, let’s dive into the core implementation details that make our news gathering worker function.\nThis post focuses on three crucial aspects:\nCookie management for authenticated access Article fetching and parsing techniques Error handling and debugging strategies Cookie Management System Many modern websites, including Nation Africa, use cookies for session management and paywalls. To access full content, we need to maintain valid session cookies.\nStoring Cookies in KV We use Cloudflare’s KV (Key-Value) store to persist cookies between worker invocations:\ninterface Env { KV: KVNamespace; // For session cookie storage ADMIN_KEY?: string; // Optional authentication key for refreshing cookies } async function getSessionCookie(env: Env): Promise\u003cstring\u003e { // Try to get the cookie from KV const cookie = await env.KV.get(\"session_cookie\"); if (!cookie) { throw new Error(\"Cookie not found. Run the extract-cookies.js script to update.\"); } // If the cookie is explicitly expired, warn but still use it if (isCookieExpired(cookie)) { console.warn(\"Warning: Cookie may be expired. Consider running extract-cookies.js.\"); } return cookie; } Checking Cookie Expiration To ensure we’re using valid cookies, I implemented a function to check cookie expiration:\nfunction isCookieExpired(cookie: string): boolean { // Extract expiration from cookie if it exists const expiresMatch = cookie.match(/expires=([^;]+)/i); if (!expiresMatch) return false; // Assume not expired if no expiration date const expiresDate = new Date(expiresMatch[1]); const now = new Date(); // If the cookie expires in less than 30 minutes, consider it expired const thirtyMinutesFromNow = new Date(now.getTime() + 30 * 60 * 1000); return expiresDate \u003c thirtyMinutesFromNow; } Cookie Refresh Process Instead of handling the login process directly in the worker (which could be complex and prone to breaking), I created a separate script extract-cookies.js that runs locally to refresh cookies.\nThe workflow is:\nRun the script locally which performs browser automation The script extracts fresh cookies from a successful login The cookies are uploaded to the Worker’s KV storage The Worker uses these cookies for subsequent requests This separation of concerns provides greater reliability and easier maintenance.\nArticle Fetching and Parsing The core functionality of our worker is fetching and parsing news articles from the target website.\nMaking Authenticated Requests To fetch article data, we make requests to the news site with our stored cookies:\nasync function fetchArticles(cookie: string): Promise\u003c{ title: string; url: string }[]\u003e { const response = await fetch(NEWS_URL, { headers: { \"Cookie\": cookie, // Add user agent to appear more like a regular browser \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\" }, }); if (!response.ok) { throw new Error(`Failed to fetch articles: ${response.status}`); } const html = await response.text(); // Parsing logic follows... } HTML Parsing with Regular Expressions For this project, I opted to use regular expressions for HTML parsing. While regex isn’t generally recommended for HTML parsing due to the complexity of HTML, it’s suitable for our targeted extraction needs and eliminates the need for heavy dependencies.\nHere’s a simplified version of the parsing logic:\nconst articleRegex = /]*)class=\"(?:[^\"]*?)(?:title|heading)(?:[^\"]*?)\"[^\u003e]*\u003e(?:\\s*)]*href=\"([^\"]*)\"[^\u003e]*\u003e(.*?)\u003c\\/a\u003e/gi; const articles: { title: string; url: string }[] = []; let match; while ((match = articleRegex.exec(html)) !== null) { const url = match[1].trim(); const title = match[2].replace(/\u003c[^\u003e]*\u003e/g, '').trim(); // Strip any HTML tags inside title articles.push({ url: url.startsWith(\"http\") ? url : `https://nation.africa${url}`, title: title, }); } This extracts article titles and URLs from heading elements that contain links.\nError Handling and Debugging Robust error handling is crucial for a production worker that runs on a schedule without direct supervision.\nComprehensive Error Handling Throughout the code, I’ve implemented try-catch blocks to prevent catastrophic failures:\nexport default { async fetch(request: Request, env: Env, ctx: ExecutionContext): Promise\u003cResponse\u003e { try { // Worker logic here } catch (error) { console.error(\"Worker error:\", error.message); return new Response(JSON.stringify({ error: error.message }), { status: 500, headers: { \"Content-Type\": \"application/json\" }, }); } } } Status Endpoint To easily check the current state of our worker, I implemented a /cookie-status endpoint:\nif (url.pathname === \"/cookie-status\") { try { const cookie = await env.KV.get(\"session_cookie\"); const cookiePresent = !!cookie; const cookieLength = cookie ? cookie.length : 0; return new Response(JSON.stringify({ cookiePresent, cookieLength, lastUpdated: await env.KV.get(\"cookie_last_updated\") || \"unknown\", isExpired: cookie ? isCookieExpired(cookie) : true }), { status: 200, headers: { \"Content-Type\": \"application/json\" } }); } catch (error) { return new Response(JSON.stringify({ error: \"Failed to check cookie status\", details: error.message }), { status: 500, headers: { \"Content-Type\": \"application/json\" } }); } } This endpoint provides quick visibility into the state of our cookie storage, which is crucial for troubleshooting.\nLogging Cloudflare Workers supports console logging, which is helpful for monitoring and debugging:\nconsole.log(\"Scheduled task running at:\", new Date().toISOString()); console.log(\"Using cookie (first 30 chars):\", cookie.substring(0, 30) + \"...\"); console.log(\"Article fetch response status:\", response.status); console.log(`Found ${articles.length} articles`); These logs can be viewed in the Cloudflare Workers dashboard or with the Wrangler CLI during development.\nTesting the Worker Locally Before deployment, it’s essential to test the worker locally. Wrangler provides a development server:\nnpm run dev This starts a local server, typically at http://localhost:8787, where you can test your worker’s HTTP endpoints.\nFor scheduled events, you can trigger them manually with:\ncurl \"http://localhost:8787/__scheduled?cron=*+*+*+*+*\" Conclusion In this part, we’ve covered the core implementation details of our news gathering Cloudflare Worker:\nStoring and managing cookies in KV storage Fetching and parsing articles using regular expressions Implementing robust error handling and debugging endpoints These components form the backbone of our worker’s functionality.\nIn Part 3, we’ll explore advanced features and deployment considerations:\nMultiple pattern matching for robust article extraction Comprehensive debugging endpoints Deployment strategies and maintenance best practices Stay tuned for the final part of this series!\n",
  "wordCount" : "933",
  "inLanguage": "en",
  "datePublished": "2025-04-07T22:53:51+03:00",
  "dateModified": "2025-04-07T22:53:51+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.guyfromtheke.com/posts/running-local-cloudflare-workers-news-part2/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Just a Guy, from Kenya",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.guyfromtheke.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.guyfromtheke.com/" accesskey="h" title="Just a Guy, from Kenya (Alt + H)">Just a Guy, from Kenya</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.guyfromtheke.com/about/" title="About">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="https://www.guyfromtheke.com/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://www.guyfromtheke.com/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://www.guyfromtheke.com/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://www.guyfromtheke.com/cv/" title="CV">
                    <span>CV</span>
                </a>
            </li>
            <li>
                <a href="https://www.guyfromtheke.com/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.guyfromtheke.com/">Home</a>&nbsp;»&nbsp;<a href="https://www.guyfromtheke.com/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Running Local Cloudflare Workers to Gather News Information - Part 2
    </h1>
    <div class="post-meta"><span title='2025-04-07 22:53:51 +0300 EAT'>April 7, 2025</span>&nbsp;·&nbsp;5 min

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#cookie-management-system" aria-label="Cookie Management System">Cookie Management System</a><ul>
                        
                <li>
                    <a href="#storing-cookies-in-kv" aria-label="Storing Cookies in KV">Storing Cookies in KV</a></li>
                <li>
                    <a href="#checking-cookie-expiration" aria-label="Checking Cookie Expiration">Checking Cookie Expiration</a></li>
                <li>
                    <a href="#cookie-refresh-process" aria-label="Cookie Refresh Process">Cookie Refresh Process</a></li></ul>
                </li>
                <li>
                    <a href="#article-fetching-and-parsing" aria-label="Article Fetching and Parsing">Article Fetching and Parsing</a><ul>
                        
                <li>
                    <a href="#making-authenticated-requests" aria-label="Making Authenticated Requests">Making Authenticated Requests</a></li>
                <li>
                    <a href="#html-parsing-with-regular-expressions" aria-label="HTML Parsing with Regular Expressions">HTML Parsing with Regular Expressions</a></li></ul>
                </li>
                <li>
                    <a href="#error-handling-and-debugging" aria-label="Error Handling and Debugging">Error Handling and Debugging</a><ul>
                        
                <li>
                    <a href="#comprehensive-error-handling" aria-label="Comprehensive Error Handling">Comprehensive Error Handling</a></li>
                <li>
                    <a href="#status-endpoint" aria-label="Status Endpoint">Status Endpoint</a></li>
                <li>
                    <a href="#logging" aria-label="Logging">Logging</a></li></ul>
                </li>
                <li>
                    <a href="#testing-the-worker-locally" aria-label="Testing the Worker Locally">Testing the Worker Locally</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>In <a href="/posts/running-local-cloudflare-workers-news-part1">Part 1</a>, we covered the basics of Cloudflare Workers and set up our project. Now, let&rsquo;s dive into the core implementation details that make our news gathering worker function.</p>
<p>This post focuses on three crucial aspects:</p>
<ol>
<li>Cookie management for authenticated access</li>
<li>Article fetching and parsing techniques</li>
<li>Error handling and debugging strategies</li>
</ol>
<h2 id="cookie-management-system">Cookie Management System<a hidden class="anchor" aria-hidden="true" href="#cookie-management-system">#</a></h2>
<p>Many modern websites, including Nation Africa, use cookies for session management and paywalls. To access full content, we need to maintain valid session cookies.</p>
<h3 id="storing-cookies-in-kv">Storing Cookies in KV<a hidden class="anchor" aria-hidden="true" href="#storing-cookies-in-kv">#</a></h3>
<p>We use Cloudflare&rsquo;s KV (Key-Value) store to persist cookies between worker invocations:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Env</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">KV</span>: <span style="color:#66d9ef">KVNamespace</span>; <span style="color:#75715e">// For session cookie storage
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">ADMIN_KEY?</span>: <span style="color:#66d9ef">string</span>; <span style="color:#75715e">// Optional authentication key for refreshing cookies
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getSessionCookie</span>(<span style="color:#a6e22e">env</span>: <span style="color:#66d9ef">Env</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">string</span>&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Try to get the cookie from KV
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cookie</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">KV</span>.<span style="color:#66d9ef">get</span>(<span style="color:#e6db74">&#34;session_cookie&#34;</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">cookie</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Cookie not found. Run the extract-cookies.js script to update.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// If the cookie is explicitly expired, warn but still use it
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isCookieExpired</span>(<span style="color:#a6e22e">cookie</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">warn</span>(<span style="color:#e6db74">&#34;Warning: Cookie may be expired. Consider running extract-cookies.js.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cookie</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="checking-cookie-expiration">Checking Cookie Expiration<a hidden class="anchor" aria-hidden="true" href="#checking-cookie-expiration">#</a></h3>
<p>To ensure we&rsquo;re using valid cookies, I implemented a function to check cookie expiration:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">isCookieExpired</span>(<span style="color:#a6e22e">cookie</span>: <span style="color:#66d9ef">string</span>)<span style="color:#f92672">:</span> <span style="color:#66d9ef">boolean</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Extract expiration from cookie if it exists
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">expiresMatch</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/expires=([^;]+)/i</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">expiresMatch</span>) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>; <span style="color:#75715e">// Assume not expired if no expiration date
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">expiresDate</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date(<span style="color:#a6e22e">expiresMatch</span>[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">now</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date();
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// If the cookie expires in less than 30 minutes, consider it expired
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">thirtyMinutesFromNow</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date(<span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getTime</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">expiresDate</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">thirtyMinutesFromNow</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="cookie-refresh-process">Cookie Refresh Process<a hidden class="anchor" aria-hidden="true" href="#cookie-refresh-process">#</a></h3>
<p>Instead of handling the login process directly in the worker (which could be complex and prone to breaking), I created a separate script <code>extract-cookies.js</code> that runs locally to refresh cookies.</p>
<p>The workflow is:</p>
<ol>
<li>Run the script locally which performs browser automation</li>
<li>The script extracts fresh cookies from a successful login</li>
<li>The cookies are uploaded to the Worker&rsquo;s KV storage</li>
<li>The Worker uses these cookies for subsequent requests</li>
</ol>
<p>This separation of concerns provides greater reliability and easier maintenance.</p>
<h2 id="article-fetching-and-parsing">Article Fetching and Parsing<a hidden class="anchor" aria-hidden="true" href="#article-fetching-and-parsing">#</a></h2>
<p>The core functionality of our worker is fetching and parsing news articles from the target website.</p>
<h3 id="making-authenticated-requests">Making Authenticated Requests<a hidden class="anchor" aria-hidden="true" href="#making-authenticated-requests">#</a></h3>
<p>To fetch article data, we make requests to the news site with our stored cookies:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">fetchArticles</span>(<span style="color:#a6e22e">cookie</span>: <span style="color:#66d9ef">string</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span><span style="color:#f92672">&lt;</span>{ <span style="color:#a6e22e">title</span>: <span style="color:#66d9ef">string</span>; <span style="color:#a6e22e">url</span>: <span style="color:#66d9ef">string</span> }[]<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">NEWS_URL</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;Cookie&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cookie</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Add user agent to appear more like a regular browser
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#e6db74">&#34;User-Agent&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">`Failed to fetch articles: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">status</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">html</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">text</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Parsing logic follows...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h3 id="html-parsing-with-regular-expressions">HTML Parsing with Regular Expressions<a hidden class="anchor" aria-hidden="true" href="#html-parsing-with-regular-expressions">#</a></h3>
<p>For this project, I opted to use regular expressions for HTML parsing. While regex isn&rsquo;t generally recommended for HTML parsing due to the complexity of HTML, it&rsquo;s suitable for our targeted extraction needs and eliminates the need for heavy dependencies.</p>
<p>Here&rsquo;s a simplified version of the parsing logic:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">articleRegex</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">/&lt;h[2-4](?:[^&gt;]*)class=&#34;(?:[^&#34;]*?)(?:title|heading)(?:[^&#34;]*?)&#34;[^&gt;]*&gt;(?:\s*)&lt;a[^&gt;]*href=&#34;([^&#34;]*)&#34;[^&gt;]*&gt;(.*?)&lt;\/a&gt;/gi</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">articles</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">title</span>: <span style="color:#66d9ef">string</span>; <span style="color:#a6e22e">url</span>: <span style="color:#66d9ef">string</span> }[] <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">match</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> ((<span style="color:#a6e22e">match</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">articleRegex</span>.<span style="color:#a6e22e">exec</span>(<span style="color:#a6e22e">html</span>)) <span style="color:#f92672">!==</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">match</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">match</span>[<span style="color:#ae81ff">2</span>].<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/&lt;[^&gt;]*&gt;/g</span>, <span style="color:#e6db74">&#39;&#39;</span>).<span style="color:#a6e22e">trim</span>(); <span style="color:#75715e">// Strip any HTML tags inside title
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">articles</span>.<span style="color:#a6e22e">push</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">url</span>: <span style="color:#66d9ef">url.startsWith</span>(<span style="color:#e6db74">&#34;http&#34;</span>) <span style="color:#f92672">?</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">`https://nation.africa</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">title</span>: <span style="color:#66d9ef">title</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This extracts article titles and URLs from heading elements that contain links.</p>
<h2 id="error-handling-and-debugging">Error Handling and Debugging<a hidden class="anchor" aria-hidden="true" href="#error-handling-and-debugging">#</a></h2>
<p>Robust error handling is crucial for a production worker that runs on a schedule without direct supervision.</p>
<h3 id="comprehensive-error-handling">Comprehensive Error Handling<a hidden class="anchor" aria-hidden="true" href="#comprehensive-error-handling">#</a></h3>
<p>Throughout the code, I&rsquo;ve implemented try-catch blocks to prevent catastrophic failures:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">request</span>: <span style="color:#66d9ef">Request</span>, <span style="color:#a6e22e">env</span>: <span style="color:#66d9ef">Env</span>, <span style="color:#a6e22e">ctx</span>: <span style="color:#66d9ef">ExecutionContext</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">Response</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Worker logic here
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;Worker error:&#34;</span>, <span style="color:#a6e22e">error</span>.<span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Response</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">error</span>: <span style="color:#66d9ef">error.message</span> }), {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">status</span>: <span style="color:#66d9ef">500</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span> },
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="status-endpoint">Status Endpoint<a hidden class="anchor" aria-hidden="true" href="#status-endpoint">#</a></h3>
<p>To easily check the current state of our worker, I implemented a <code>/cookie-status</code> endpoint:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">pathname</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;/cookie-status&#34;</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cookie</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">KV</span>.<span style="color:#66d9ef">get</span>(<span style="color:#e6db74">&#34;session_cookie&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cookiePresent</span> <span style="color:#f92672">=</span> <span style="color:#f92672">!!</span><span style="color:#a6e22e">cookie</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cookieLength</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cookie</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">cookie.length</span> : <span style="color:#66d9ef">0</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Response</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">cookiePresent</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">cookieLength</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">lastUpdated</span>: <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">KV</span>.<span style="color:#66d9ef">get</span>(<span style="color:#e6db74">&#34;cookie_last_updated&#34;</span>) <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;unknown&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">isExpired</span>: <span style="color:#66d9ef">cookie</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">isCookieExpired</span>(<span style="color:#a6e22e">cookie</span>) <span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    }), {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">status</span>: <span style="color:#66d9ef">200</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span> }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Response</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ 
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">error</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Failed to check cookie status&#34;</span>, 
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">details</span>: <span style="color:#66d9ef">error.message</span> 
</span></span><span style="display:flex;"><span>    }), {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">status</span>: <span style="color:#66d9ef">500</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { <span style="color:#e6db74">&#34;Content-Type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span> }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This endpoint provides quick visibility into the state of our cookie storage, which is crucial for troubleshooting.</p>
<h3 id="logging">Logging<a hidden class="anchor" aria-hidden="true" href="#logging">#</a></h3>
<p>Cloudflare Workers supports console logging, which is helpful for monitoring and debugging:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Scheduled task running at:&#34;</span>, <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>());
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Using cookie (first 30 chars):&#34;</span>, <span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">30</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Article fetch response status:&#34;</span>, <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">status</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Found </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">articles</span>.<span style="color:#a6e22e">length</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> articles`</span>);
</span></span></code></pre></div><p>These logs can be viewed in the Cloudflare Workers dashboard or with the Wrangler CLI during development.</p>
<h2 id="testing-the-worker-locally">Testing the Worker Locally<a hidden class="anchor" aria-hidden="true" href="#testing-the-worker-locally">#</a></h2>
<p>Before deployment, it&rsquo;s essential to test the worker locally. Wrangler provides a development server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm run dev
</span></span></code></pre></div><p>This starts a local server, typically at http://localhost:8787, where you can test your worker&rsquo;s HTTP endpoints.</p>
<p>For scheduled events, you can trigger them manually with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl <span style="color:#e6db74">&#34;http://localhost:8787/__scheduled?cron=*+*+*+*+*&#34;</span>
</span></span></code></pre></div><h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>In this part, we&rsquo;ve covered the core implementation details of our news gathering Cloudflare Worker:</p>
<ul>
<li>Storing and managing cookies in KV storage</li>
<li>Fetching and parsing articles using regular expressions</li>
<li>Implementing robust error handling and debugging endpoints</li>
</ul>
<p>These components form the backbone of our worker&rsquo;s functionality.</p>
<p>In <a href="/posts/running-local-cloudflare-workers-news-part3">Part 3</a>, we&rsquo;ll explore advanced features and deployment considerations:</p>
<ul>
<li>Multiple pattern matching for robust article extraction</li>
<li>Comprehensive debugging endpoints</li>
<li>Deployment strategies and maintenance best practices</li>
</ul>
<p>Stay tuned for the final part of this series!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.guyfromtheke.com/tags/cloudflare/">Cloudflare</a></li>
      <li><a href="https://www.guyfromtheke.com/tags/workers/">Workers</a></li>
      <li><a href="https://www.guyfromtheke.com/tags/web-scraping/">Web Scraping</a></li>
      <li><a href="https://www.guyfromtheke.com/tags/typescript/">Typescript</a></li>
      <li><a href="https://www.guyfromtheke.com/tags/serverless/">Serverless</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://www.guyfromtheke.com/posts/running-local-cloudflare-workers-news-part3/">
    <span class="title">« Prev</span>
    <br>
    <span>Running Local Cloudflare Workers to Gather News Information - Part 3</span>
  </a>
  <a class="next" href="https://www.guyfromtheke.com/posts/running-local-cloudflare-workers-news-part1/">
    <span class="title">Next »</span>
    <br>
    <span>Running Local Cloudflare Workers to Gather News Information - Part 1</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Running Local Cloudflare Workers to Gather News Information - Part 2 on x"
            href="https://x.com/intent/tweet/?text=Running%20Local%20Cloudflare%20Workers%20to%20Gather%20News%20Information%20-%20Part%202&amp;url=https%3a%2f%2fwww.guyfromtheke.com%2fposts%2frunning-local-cloudflare-workers-news-part2%2f&amp;hashtags=cloudflare%2cworkers%2cwebscraping%2ctypescript%2cserverless">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Running Local Cloudflare Workers to Gather News Information - Part 2 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.guyfromtheke.com%2fposts%2frunning-local-cloudflare-workers-news-part2%2f&amp;title=Running%20Local%20Cloudflare%20Workers%20to%20Gather%20News%20Information%20-%20Part%202&amp;summary=Running%20Local%20Cloudflare%20Workers%20to%20Gather%20News%20Information%20-%20Part%202&amp;source=https%3a%2f%2fwww.guyfromtheke.com%2fposts%2frunning-local-cloudflare-workers-news-part2%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Running Local Cloudflare Workers to Gather News Information - Part 2 on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fwww.guyfromtheke.com%2fposts%2frunning-local-cloudflare-workers-news-part2%2f&title=Running%20Local%20Cloudflare%20Workers%20to%20Gather%20News%20Information%20-%20Part%202">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Running Local Cloudflare Workers to Gather News Information - Part 2 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.guyfromtheke.com%2fposts%2frunning-local-cloudflare-workers-news-part2%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Running Local Cloudflare Workers to Gather News Information - Part 2 on whatsapp"
            href="https://api.whatsapp.com/send?text=Running%20Local%20Cloudflare%20Workers%20to%20Gather%20News%20Information%20-%20Part%202%20-%20https%3a%2f%2fwww.guyfromtheke.com%2fposts%2frunning-local-cloudflare-workers-news-part2%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Running Local Cloudflare Workers to Gather News Information - Part 2 on telegram"
            href="https://telegram.me/share/url?text=Running%20Local%20Cloudflare%20Workers%20to%20Gather%20News%20Information%20-%20Part%202&amp;url=https%3a%2f%2fwww.guyfromtheke.com%2fposts%2frunning-local-cloudflare-workers-news-part2%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Running Local Cloudflare Workers to Gather News Information - Part 2 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Running%20Local%20Cloudflare%20Workers%20to%20Gather%20News%20Information%20-%20Part%202&u=https%3a%2f%2fwww.guyfromtheke.com%2fposts%2frunning-local-cloudflare-workers-news-part2%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer><div class="comments">
    
    <script src="https://utteranc.es/client.js"
            repo="guyfromtheke/guyfromtheke"
            issue-term="pathname"
            label="comment"
            theme="preferred-color-scheme"
            crossorigin="anonymous"
            async>
    </script>
</div>



</article>
    </main>
    
<footer class="footer">
        <span>© <a href="https://github.com/adityatelange/hugo-PaperMod/graphs/contributors">PaperMod Contributors</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
